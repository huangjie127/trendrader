# TrendRadar 主题追踪系统 - 使用说明

## 📋 MVP版本完成内容

### ✅ 已实现的功能

1. **主题分类系统**
   - 复用现有关键词匹配逻辑
   - 支持普通关键词和正则表达式
   - 自动归类热榜和RSS数据

2. **主题存储**
   - Markdown文件格式存储
   - 按日期组织（`output/topics/{topic_id}/{date}.md`）
   - 包含统计摘要、内容列表、人工标注区域

3. **历史摘要生成**
   - 自动读取最近7天（可配置）的主题数据
   - 生成结构化摘要文本

4. **AI分析增强**
   - 历史上下文自动注入AI分析
   - AI可参考历史数据进行趋势分析

5. **配置文件**
   - `config/topics.yaml` - 主题定义
   - `config/config.yaml` - 主题追踪配置段

---

## 🚀 快速开始

### 1. 启用主题追踪

编辑 `config/config.yaml`，确保主题追踪已启用：

```yaml
topics:
  enabled: true                       # 启用主题追踪
  config_file: "config/topics.yaml"   
  archive_days: 7                     # AI分析时包含7天历史
  max_items_per_topic: 20             
  base_dir: "output/topics"           
```

### 2. 配置主题

编辑 `config/topics.yaml`，定义你关心的主题：

```yaml
topics:
  - id: "ai-tech"
    name: "AI与科技"
    description: "人工智能相关"
    keywords:
      - "AI"
      - "人工智能"
      - "ChatGPT"
      - "/GPT-\\d+/"
    priority: 1
```

### 3. 运行系统

```bash
python -m trendradar
```

### 4. 查看结果

主题归档文件会保存在：
```
output/topics/
├── ai-tech/
│   ├── 2026-01-20.md
│   └── 2026-01-19.md
└── economy-finance/
    └── 2026-01-20.md
```

---

## 📁 主题档案文件格式

每个Markdown文件包含：

```markdown
# AI与科技 - 2026-01-20

## 📊 统计摘要
- **总条目**: 15 条
- **热榜来源**: 12 条
- **RSS来源**: 3 条

## 📰 内容列表

### 热榜新闻
1. **[ChatGPT发布新功能](url)**
   - 来源: 知乎 | 出现 3 次
   - 排名: #1, #2, #5
   - 时间: 09:00 ~ 12:00

### RSS订阅
1. **[AI研究新突破](url)**
   - 来源: Hacker News
   - 发布时间: 2026-01-20 10:00
   - 摘要: ...

---

## 🖊️ 人工备注
<!-- 在此添加你的分析和思考 -->

## ⭐ 重要度标记
重要度: ☐ 1星 ☐ 2星 ☐ 3星 ☐ 4星 ☐ 5星
```

---

## 🤖 AI分析增强

当主题追踪启用且有历史数据时，AI分析会自动包含历史上下文：

### AI会看到的额外信息：

```markdown
## 📊 最近7天同主题历史

> 时间范围: 2026-01-13 至 2026-01-19

### AI与科技
**2026-01-19**: 12条 (热榜10, RSS2)
  > 备注: 用户标注的重点内容

**2026-01-18**: 8条 (热榜6, RSS2)

### 经济金融
**2026-01-19**: 15条 (热榜15, RSS0)
```

### AI可以做的分析：

- **变化趋势**："与上周相比，AI相关新闻增加了30%"
- **持续性话题**："ChatGPT功能更新已连续3天占据热榜"
- **异常信号**："今天突然出现大量经济下行新闻，注意关注"

---

## 🔧 高级配置

### 主题配置选项

```yaml
topics:
  - id: "topic-id"           # 唯一标识符（英文，用于文件夹名）
    name: "主题名称"          # 显示名称（支持中文）
    description: "主题描述"   # 可选
    keywords:                # 关键词列表
      - "关键词1"
      - "/正则表达式/"
    priority: 1              # 优先级（数字越小越重要）
```

### 系统配置选项

```yaml
topics:
  enabled: true              # 总开关
  archive_days: 7            # 历史上下文天数（0=禁用历史）
  max_items_per_topic: 20    # 每天每主题最多条目（0=无限制）
  base_dir: "output/topics"  # 存储目录
```

---

## 💡 使用建议

### 1. 主题定义策略

**建议主题数量**：3-5个
- 太多：信息过载
- 太少：无法细分

**关键词选择**：
- 使用核心词汇（如"AI"而非"人工智能技术"）
- 避免过于宽泛（如"科技"）
- 正则表达式用于精确匹配（如`/\bAI\b/`避免误匹配）

### 2. 人工标注技巧

在Markdown文件的`🖊️ 人工备注`区域添加：
- **关键发现**：今天最重要的3条信息
- **趋势判断**：上升/下降/持平
- **待跟进**：需要进一步关注的事项

### 3. AI分析优化

- **启用历史上下文**：`archive_days: 7`
- **适当限制条目**：`max_items_per_topic: 15`（避免token超限）
- **添加人工标注**：AI会读取你的备注作为参考

---

## 🎯 MVP版本的限制

### 当前未实现：

1. **推送内容中显示主题摘要**（仅存储到文件）
2. **Web UI界面**（需手动打开Markdown文件）
3. **主题配置热更新**（需重启服务）
4. **远程存储的历史查询**（仅本地存储支持）

### 后续可扩展：

- 推送中添加"📌 主题归档"板块
- 简单的Web UI（主题列表、时间线视图）
- 主题间的关联分析
- 自动生成周报/月报

---

## ❓ 常见问题

### Q: 如何禁用主题追踪？
A: 在`config/config.yaml`中设置`topics.enabled: false`

### Q: 主题文件在哪里？
A: `output/topics/{topic_id}/{date}.md`

### Q: AI没有使用历史数据？
A: 检查：
1. `topics.enabled: true`
2. `topics.archive_days > 0`
3. 主题目录中有历史文件

### Q: 如何修改历史天数？
A: 修改`topics.archive_days`（建议3-7天）

### Q: 主题分类不准确？
A: 调整`config/topics.yaml`中的关键词，支持正则表达式

---

## 📊 工作流程

```
1. 数据抓取
   ↓
2. 关键词匹配统计（原有功能）
   ↓
3. 主题分类 ← 新增
   ↓
4. 主题存储（Markdown） ← 新增
   ↓
5. 历史摘要生成 ← 新增
   ↓
6. AI分析（注入历史上下文） ← 增强
   ↓
7. 推送通知
```

---

## 🎉 完成！

MVP版本的主题追踪系统已经可以工作。现在：

1. ✅ 新闻自动归类到主题
2. ✅ 每日生成主题档案（Markdown）
3. ✅ AI分析时自动参考历史
4. ✅ 支持人工标注和知识沉淀

开始使用吧！
